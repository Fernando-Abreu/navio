<!DOCTYPE html>
<html>
<head>
  <title>Navio example: IEEEVIS Publications</title>
  <style>
    body {
      font-family: sans-serif;
    }
  </style>
</head>
<body>
  <h1>IEEEVIS Publications 1990-2018</h1>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>

  <!-- Placeholder for the widget -->
  <div id="target" style="width:55%; float:left; overflow-x: scroll;"></div>
  <div style="width:45%; float:left">
    <h2>Papers</h2>
    <span id="paperCount"></span>
    <table cellpadding="10">
      <tr>
        <th>Title</th>
        <th>Conference</th>
        <th>Year</th>
        <th>XPloreCitationCount_02-2019</th>
      </tr>
      <tbody id="papers">
      </tbody>
    </table>
  </div>


  <!-- Step 0: Load the libraries -->
  <script src="https://d3js.org/d3.v5.js"></script>
  <script src="https://unpkg.com/popper.js@1.14/dist/umd/popper.min.js"></script>
  <!-- <script src="https://unpkg.com/navio@0.0.36/dist/navio.min.js"></script> -->
  <script src="../dist/navio.js"></script>

<script>
/* global d3, navio */

// Step 1.  Create a navio passing the selector to place it and the height
var nn = navio(d3.select("#target"), 800)
  .sortBy("XPloreCitationCount_02-2019", false);

// Step 1.5 (Optional) Set parameters
nn.attribWidth = 10;
nn.attribFontSize = 9;
// nn.tooltipMargin = 0;
nn.y0 = 150;

d3.csv("./IEEE VIS papers 1990-2018 - Main dataset.csv", d3.autoType)
  .then(function (data) {
    // Step 2. Load your data!
    nn.data(data);

    // Step 3 autodetect the attributes
    nn.addAllAttribs();

    // Step 4 (optional) add a callback for when updating
    nn.updateCallback(populateTable);

    populateTable(data);
  });


function populateTable(data) {
  const NumPaperToShow = 20;
  d3.select("#paperCount").text(`Showing ${NumPaperToShow} out of ${data.length}`);
  d3.select("#papers")
    .selectAll("tr").remove();
  let trs = d3.select("#papers")
    .selectAll("tr")
    .data(data
      .slice(0,NumPaperToShow))
    .enter()
    .append("tr");

  trs.append("td").text(d=> d.Title);
  trs.append("td").text(d=> d.Conference);
  trs.append("td").text(d=> d.Year);
  trs.append("td").text(d=> d["XPloreCitationCount_02-2019"]);

}

</script>
</body>
</html>
